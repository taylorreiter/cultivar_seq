Update sourmash from github. Delete all signatures, and rerun. 

Run `sourmash sbt_gather` on the quality controlled olive fruit reads. 

Here, quality controlled is defined as trimmomatic and khmer `trim-low-abund --variable coverage <...>` (see 0.preprocessing).

```
cd /mnt/work/sourmash
mkdir sbt_gather
cd sbt_gather
ln -s ../signatures/*sig .
```

```
source ~/sourmashEnv2/bin/activate
for infile in *.sig
  do
    sourmash sbt_gather -k 31 ~/sourmash_SBTs/fungal_4.13.17.sbt.json --threshold=0.001 -o fungal_k31_${infile}.txt ${infile}
 done
```

Run sourmash again...the first few files were empty and I'm skeptical of this

4/25/17: there was a bug preventing the output from writing to files appropriately.
```
for infile in *.sig
  do
    sourmash sbt_gather -k 31 ~/sourmash_SBTs/fungal_4.13.17.sbt.json --threshold=0.001 -o fungal_trial2_k31_${infile}.txt ${infile}
 done
 ```
 
 Check for reference genome content
```
cd /mnt/work/sourmash/sbt_gather
source ~/sourmashEnv2/bin/activate
for infile in *.sig
  do
    sourmash sbt_gather -k 31 ~/sourmash_SBTs/olive_ref/olive_ref_4.18.17.sbt.json --threshold=0.001 -o olive_k31_${infile}.txt ${infile}
 done
```

Run against the k31 microbes sbt to see what is present other than fungus
Need to re-run this. 
```
for infile in *.sig
  do
    sourmash sbt_gather -k 31 ~/sourmash_SBTs/microbes.k31.sbt.json --threshold=0.001 -o microbe_k31_${infile}.txt ${infile}
done
```

-----------------------------------
 
 4/27/17 after updating sourmash to the metagenomes-2017 branch, and after re-calculating signatures at a `--scaled 1000` for all RNA-seq files and for the fungal SBT, re-run these `sbt_gather` on RNA-seq samples.
 
 First, move all of the above runs in to a folder named `sig`, then make the new `sbt_gather` output write to a folder named `sig3`
 ```
 cd /mnt/work/sourmash/sbt_gather
 mkdir sig
 
 for infile in *
 do 
   mv $infile ./sig/$infile
 done
 
 mkdir sig3
 cd sig3
 ```
 
Link in signatures files from folder `signature3`, which contain signatures from RNA-seq reads trimmed with `trim-low-abund.py -v`, and with signatures calculated at `-k 21,31,51` and `--scaled 1000`
```
ln -s ../../signatures3/*sig3 .
```
 
Use `sbt_gather` with the new SBTs where all fungal sigs were calculated with `--scaled 1000` and `-k 21,31,51`.
```
cd /mnt/work/sourmash/sbt_gather/*sig3

for infile in *sig3 
do
    /usr/bin/time -v -o time_fungi_k21_s1000.txt -- sourmash sbt_gather -k 21 ~/sourmash_SBTs/fungal_k21_s1000/fungal_k21_s1000.sbt.json $infile --threshold-bp=0 -o fungi_k21__s1000_{infile}.txt
done
```
Because this takes so long, write individual commands for different files and execute in parallel in different tmux windows. Also make the the threshold bp 1000. 

RUNNING:
```
sourmash sbt_gather -k 21 ~/sourmash_SBTs/fungal_k21_s1000/fungal_k21_s1000.sbt.json SRR1573503qc.abundtrim.fq.gz.sig3 --threshold-bp=1000 -o fungi_k21_s1000_SRR1573503qc.abundtrim.fq.gz.sig3.txt
```
RUNNING:
```
sourmash sbt_gather -k 21 ~/sourmash_SBTs/fungal_k21_s1000/fungal_k21_s1000.sbt.json SRR1574328qc.abundtrim.fq.gz.sig3 --threshold-bp=1000 -o fungi_k21_s1000_SRR1574328qc.abundtrim.fq.gz.sig3.txt
```
RUNNING:
```
sourmash sbt_gather -k 21 ~/sourmash_SBTs/fungal_k21_s1000/fungal_k21_s1000.sbt.json SRR1574719qc.abundtrim.fq.gz.sig3 --threshold-bp=1000 -o fungi_k21_s1000_SRR1574719qc.abundtrim.fq.gz.sig3.txt
```
RUNNING:
```
sourmash sbt_gather -k 21 ~/sourmash_SBTs/fungal_k21_s1000/fungal_k21_s1000.sbt.json SRR1574772qc.abundtrim.fq.gz.sig3 --threshold-bp=1000 -o fungi_k21_s1000_SRR1574772qc.abundtrim.fq.gz.sig3.txt
```

```
sourmash sbt_gather -k 21 ~/sourmash_SBTs/fungal_k21_s1000/fungal_k21_s1000.sbt.json SRR4236909qc.abundtrim.fq.gz.sig3 --threshold-bp=1000 -o fungi_k21_s1000_SRR4236909qc.abundtrim.fq.gz.sig3.txt
```

```
sourmash sbt_gather -k 21 ~/sourmash_SBTs/fungal_k21_s1000/fungal_k21_s1000.sbt.json SRR4236910qc.abundtrim.fq.gz.sig3 --threshold-bp=1000 -o fungi_k21_s1000_SRR4236910qc.abundtrim.fq.gz.sig3.txt
```

```
sourmash sbt_gather -k 21 ~/sourmash_SBTs/fungal_k21_s1000/fungal_k21_s1000.sbt.json SRR4236911qc.abundtrim.fq.gz.sig3 --threshold-bp=1000 -o fungi_k21_s1000_SRR4236911qc.abundtrim.fq.gz.sig3.txt
```

```
sourmash sbt_gather -k 21 ~/sourmash_SBTs/fungal_k21_s1000/fungal_k21_s1000.sbt.json SRR4236912qc.abundtrim.fq.gz.sig3 --threshold-bp=1000 -o fungi_k21_s1000_SRR4236912qc.abundtrim.fq.gz.sig3.txt
```

Then repeat for larger k values: (complete at a later time -- `sbt_gather` takes a long time with this large of a tree at `--scaled 1000`)
```
for infile in *sig3 
do
    /usr/bin/time -v -o time_fungi_k31_s1000.txt -- sourmash sbt_gather -k 31 ~/sourmash_SBTs/fungal_k31_s1000/fungal_k31_s1000.sbt.json $infile --threshold-bp=0 -o fungi_k31_$infile.txt
done
```
```
for infile in *sig3 
do
    /usr/bin/time -v -o time_fungi_k51_s1000.txt -- sourmash sbt_gather -k 51 ~/sourmash_SBTs/fungal_k51_s1000/fungal_k51_s1000.sbt.json $infile --threshold-bp=0 -o fungi_k51_$infile.txt
done
```
 



