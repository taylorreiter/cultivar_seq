fastq-dump -A SRR2018860 --gzip
fastq-dump -A SRR2018884 --gzip

# check if files are paired end
grep 'GTTGGAACCGAAAGGGTTTGAATTCAAACCCTTTCGGTTCCAAC' SRR2018860.fastq | wc -l
grep 'GTTGGAACCGAAAGGGTTTGAATTCAAACCCTTTCGGTTCCAAC' SRR2018884.fastq | wc -l

fastqc *fastq.gz

# Trim adapters
# http://seqanswers.com/forums/showthread.php?t=2698
# >454titanium
# TCGTATAACTTCGTATAATGTATGCTATACGAAGTTATTACG
# CGTAATAACTTCGTATAGCATACATTATACGAAGTTATACGA
# >454flx
# GTTGGAACCGAAAGGGTTTGAATTCAAACCCTTTCGGTTCCAAC
# >454flx2
# CAACCTTGGCTTTCCCAAACTTAAGTTTGGGAAAGCCAAGGTTG

trimmomatic SE SRR2018884.fastq.gz SRR2018884_trim.fastq.gz ILLUMINACLIP:454_adaptors.fa:2:30:10 MINLEN:25
trimmomatic SE SRR2018860.fastq.gz SRR2018860_trim.fastq.gz ILLUMINACLIP:454_adaptors.fa:2:30:10 MINLEN:25

fastqc *trim*

validate_mapping_file.py -o vmf-map/ -m map.tsv

# samples are already in different files.
split_libraries_fastq.py -i lane1_read1.fastq.gz,lane2_read1.fastq.gz --sample_ids my.sample.1,my.sample.2 -o slout_not_multiplexed_q20/ -q 19 --barcode_type 'not-barcoded'

split_libraries_fastq.py -i SRR2018884.fastq.gz,SRR2018860.fastq.gz --sample_ids SRR2018884,SRR2018860 -o slout_not_multiplexed_q20/ -q 19 --barcode_type 'not-barcoded'

mkdir sl_out

split_libraries_fastq.py -i SRR2018884.fastq.gz,SRR2018860.fastq.gz --sample_ids SRR2018884,SRR2018860 -o sl_out/ -q 19 --barcode_type 'not-barcoded'
